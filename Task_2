Задание №2
Постановка:  Имеется таблица:

CREATE TABLE call 
  ( 
     subscriber_name VARCHAR(64) NOT NULL, 
     event_date      DATETIME NOT NULL, 
     event_cnt       INT NOT NULL 
  ) 

Требуется написать запрос, возвращающий для каждого абонента минимальную дату, когда количество событий по абоненту было максимально, 
и максимальную дату, когда количество событий по абоненту было минимально, а также количество событий.

Сделано не до конца.

WITH ty AS 
( 
SELECT subscriber_name, event_date, event_cnt  
FROM call
WHERE event_cnt = (SELECT MAX(event_cnt) from call)
GROUP BY event_date, subscriber_name, event_cnt
)

SELECT subscriber_name, event_date, event_cnt 
from ty
WHERE event_date = (SELECT MIN(event_date) as mindate from ty)
